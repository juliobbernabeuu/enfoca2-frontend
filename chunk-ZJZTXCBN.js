import{a as ie}from"./chunk-LH4K7IS7.js";import{A as c,B as z,C as r,D as f,E as h,F as L,G as H,H as W,K as C,L as S,M as G,P as k,Q as M,S as F,U as w,Y as J,ca as K,ea as q,f as N,fa as Q,g as E,ga as X,h as O,j as d,ja as Y,k as u,l as $,la as Z,m as l,n as I,o as v,p as U,pa as ee,q as _,qa as te,r as m,ra as B,t,u as i,v as x,w as A,x as R,y as g,z as p}from"./chunk-Y2HWLAXH.js";var V=class n{static \u0275fac=function(e){return new(e||n)};static \u0275cmp=v({type:n,selectors:[["app-admin-panel"]],decls:12,vars:0,consts:[[1,"container","d-flex","justify-content-center","align-items-center",2,"min-height","70vh"],[1,"card","shadow-lg","border-0","rounded-4",2,"width","100%","max-width","400px"],[1,"card-header","bg-dark","text-white","text-center","rounded-top-4"],[1,"mb-0"],[1,"card-body","d-flex","flex-column","gap-4","p-4"],["routerLink","/admin/ban-user",1,"btn","btn-outline-primary","btn-lg","d-flex","align-items-center","justify-content-center","gap-2"],[1,"bi","bi-person-slash-fill"],["routerLink","/admin/delete-photo",1,"btn","btn-outline-danger","btn-lg","d-flex","align-items-center","justify-content-center","gap-2"],[1,"bi","bi-trash3-fill"]],template:function(e,a){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),r(4,"Panel de Administraci\xF3n"),i()(),t(5,"div",4)(6,"a",5),x(7,"i",6),r(8," Banear Usuario "),i(),t(9,"a",7),x(10,"i",8),r(11," Eliminar Foto "),i()()()())},dependencies:[K],encapsulation:2})};var D=class n{constructor(o){this.http=o}apiUrl="https://enfoca2-backend.onrender.com/api/usuarios";obtenerUsuarios(){return this.http.get(this.apiUrl)}bloquearUsuario(o,e){return this.http.post(`${this.apiUrl}/${o}/bloquear`,{dias:e})}obtenerComentariosPorUsuario(o){return this.http.get(`https://enfoca2-backend.onrender.com/api/comentarios/usuario/${o}`)}static \u0275fac=function(e){return new(e||n)(O(J))};static \u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})};function le(n,o){if(n&1){let e=g();t(0,"tr")(1,"td"),r(2),i(),t(3,"td"),r(4),i(),t(5,"td"),r(6),i(),t(7,"td"),r(8),C(9,"date"),i(),t(10,"td")(11,"button",9),p("click",function(){let s=d(e).$implicit,b=c();return u(b.seleccionarUsuario(s))}),x(12,"i",10),r(13," Bloquear "),i(),t(14,"button",11),p("click",function(){let s=d(e).$implicit,b=c();return u(b.mostrarComentarios(s.id_usuario))}),x(15,"i",12),r(16," Mostrar comentarios "),i()()()}if(n&2){let e=o.$implicit;l(2),f(e.nombre),l(2),f(e.email),l(2),f(e.rol),l(2),h(" ",e.bloqueado_hasta?S(9,4,e.bloqueado_hasta,"dd/M/yy"):"No tiene"," ")}}function se(n,o){if(n&1){let e=g();t(0,"div",13)(1,"div",14)(2,"button",15),p("click",function(){d(e);let s=c();return u(s.cerrarModal())}),i(),t(3,"h5",16),r(4,"Bloquear a "),t(5,"strong"),r(6),i()(),t(7,"div",16)(8,"label",17),r(9,"D\xEDas de bloqueo:"),i(),t(10,"input",18),W("ngModelChange",function(s){d(e);let b=c();return H(b.diasBloqueo,s)||(b.diasBloqueo=s),u(s)}),i()(),t(11,"div",19)(12,"button",20),p("click",function(){d(e);let s=c();return u(s.bloquearUsuario())}),r(13,"Confirmar"),i(),t(14,"button",21),p("click",function(){d(e);let s=c();return u(s.cerrarModal())}),r(15,"Cancelar"),i()()()()}if(n&2){let e=c();l(6),f(e.usuarioSeleccionado.nombre),l(4),L("ngModel",e.diasBloqueo)}}function ce(n,o){if(n&1&&(t(0,"li",27),r(1),t(2,"span",28),r(3),C(4,"date"),i()()),n&2){let e=o.$implicit;l(),h(" ",e.contenido," "),l(2),f(S(4,2,e.fecha,"dd-MM-yyyy"))}}function me(n,o){if(n&1&&(A(0),t(1,"ul",25),_(2,ce,5,5,"li",26),i(),R()),n&2){let e=c(2);l(2),m("ngForOf",e.comentarios)}}function de(n,o){n&1&&(t(0,"div",29),r(1," Este usuario no tiene comentarios. "),i())}function ue(n,o){if(n&1){let e=g();t(0,"div",13)(1,"div",22)(2,"button",15),p("click",function(){d(e);let s=c();return u(s.cerrarModalComentarios())}),i(),t(3,"h5",23),r(4," Comentarios de "),t(5,"strong"),r(6),i()(),_(7,me,3,1,"ng-container",24)(8,de,2,0,"ng-template",null,0,G),i()()}if(n&2){let e=z(9),a=c();l(6),f(a.usuarioComentarios==null?null:a.usuarioComentarios.nombre),l(),m("ngIf",a.comentarios.length>0)("ngIfElse",e)}}function pe(n,o){if(n&1&&(t(0,"div",30),r(1),i()),n&2){let e=c();l(),h(" ",e.mensaje," ")}}var j=class n{constructor(o){this.usuarioService=o}usuarios=[];usuarioSeleccionado=null;diasBloqueo=1;mensaje="";comentarios=[];mostrarModalComentarios=!1;usuarioComentarios=null;ngOnInit(){this.cargarUsuarios()}cargarUsuarios(){this.usuarioService.obtenerUsuarios().subscribe({next:o=>this.usuarios=o,error:o=>console.error(o)})}seleccionarUsuario(o){this.usuarioSeleccionado=o,this.diasBloqueo=1}cerrarModal(){this.usuarioSeleccionado=null}bloquearUsuario(){this.usuarioSeleccionado&&this.usuarioService.bloquearUsuario(this.usuarioSeleccionado.id_usuario,this.diasBloqueo).subscribe({next:()=>{this.mensaje=`Usuario ${this.usuarioSeleccionado?.nombre} bloqueado por ${this.diasBloqueo} d\xEDa(s).`,this.usuarioSeleccionado=null,this.comentarios=[],this.cargarUsuarios()},error:()=>this.mensaje="Error al bloquear el usuario."})}mostrarComentarios(o){let e=this.usuarios.find(a=>a.id_usuario===o);e&&(this.usuarioComentarios=e),this.usuarioService.obtenerComentariosPorUsuario(o).subscribe({next:a=>{this.comentarios=a,this.mostrarModalComentarios=!0,this.mensaje=""},error:a=>{console.error(a),this.mensaje="Error al cargar comentarios.",this.comentarios=[],this.mostrarModalComentarios=!1}})}cerrarModalComentarios(){this.mostrarModalComentarios=!1,this.comentarios=[],this.usuarioComentarios=null}static \u0275fac=function(e){return new(e||n)(I(D))};static \u0275cmp=v({type:n,selectors:[["app-ban-user"]],decls:22,vars:4,consts:[["sinComentarios",""],[1,"container","mt-4"],[1,"mb-4","text-center"],[1,"table-responsive"],[1,"table","table-striped","table-bordered","align-middle","text-center","rounded-4","overflow-hidden"],[1,"table-dark"],[4,"ngFor","ngForOf"],["class","position-fixed top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center bg-dark bg-opacity-75","style","z-index: 1050;",4,"ngIf"],["class","alert alert-info mt-3 rounded-3 shadow-sm text-center",4,"ngIf"],[1,"btn","btn-warning","btn-sm","me-2",3,"click"],[1,"bi","bi-slash-circle","me-1"],[1,"btn","btn-info","btn-sm",3,"click"],[1,"bi","bi-chat-left-text","me-1"],[1,"position-fixed","top-0","start-0","w-100","h-100","d-flex","justify-content-center","align-items-center","bg-dark","bg-opacity-75",2,"z-index","1050"],[1,"bg-white","p-4","rounded","shadow","position-relative",2,"width","90%","max-width","400px"],["type","button","aria-label","Cerrar",1,"btn-close","position-absolute","top-0","end-0","m-2",3,"click"],[1,"mb-3"],["for","dias",1,"form-label"],["type","number","id","dias","min","1","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","gap-2"],[1,"btn","btn-danger","w-50",3,"click"],[1,"btn","btn-secondary","w-50",3,"click"],[1,"bg-white","p-4","rounded","shadow","position-relative",2,"width","90%","max-width","500px","max-height","80vh","overflow-y","auto"],[1,"text-center","mb-3"],[4,"ngIf","ngIfElse"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"text-muted","float-end"],[1,"alert","alert-warning","text-center"],[1,"alert","alert-info","mt-3","rounded-3","shadow-sm","text-center"]],template:function(e,a){e&1&&(t(0,"div",1)(1,"h2",2),r(2,"Usuarios"),i(),t(3,"div",3)(4,"table",4)(5,"thead",5)(6,"tr")(7,"th"),r(8,"Nombre"),i(),t(9,"th"),r(10,"Email"),i(),t(11,"th"),r(12,"Rol"),i(),t(13,"th"),r(14,"Bloqueo"),i(),t(15,"th"),r(16,"Acciones"),i()()(),t(17,"tbody"),_(18,le,17,7,"tr",6),i()()(),_(19,se,16,2,"div",7)(20,ue,10,3,"div",7)(21,pe,2,1,"div",8),i()),e&2&&(l(18),m("ngForOf",a.usuarios),l(),m("ngIf",a.usuarioSeleccionado),l(),m("ngIf",a.mostrarModalComentarios),l(),m("ngIf",a.mensaje))},dependencies:[w,k,M,F,B,Q,Z,X,te,ee,Y],encapsulation:2})};function fe(n,o){if(n&1&&(t(0,"div",11),r(1),i()),n&2){let e=c();l(),h(" ",e.mensaje," ")}}function xe(n,o){n&1&&(t(0,"div",12)(1,"div",13)(2,"span",14),r(3,"Cargando..."),i()()())}function be(n,o){if(n&1){let e=g();t(0,"tr",18),p("click",function(){let s=d(e).$implicit,b=c(2);return u(b.seleccionarFoto(s))}),t(1,"td"),r(2),i(),t(3,"td"),r(4),i(),t(5,"td"),r(6),C(7,"date"),i(),t(8,"td")(9,"button",19),p("click",function(s){let b=d(e).$implicit;return c(2).eliminarFoto(b),u(s.stopPropagation())}),x(10,"i",20),r(11,"Eliminar "),i()()()}if(n&2){let e=o.$implicit;l(2),f(e.titulo),l(2),f(e.id_usuario),l(2),f(S(7,3,e.fecha,"shortDate"))}}function _e(n,o){if(n&1&&(t(0,"table",15)(1,"thead",16)(2,"tr")(3,"th"),r(4,"Nombre"),i(),t(5,"th"),r(6,"Usuario"),i(),t(7,"th"),r(8,"Fecha"),i(),t(9,"th"),r(10,"Acciones"),i()()(),t(11,"tbody"),_(12,be,12,6,"tr",17),i()()),n&2){let e=c();l(12),m("ngForOf",e.fotos)}}function he(n,o){n&1&&(t(0,"div",21),r(1," No hay fotos para mostrar. "),i())}function ge(n,o){if(n&1){let e=g();t(0,"div",22)(1,"div",23)(2,"button",24),p("click",function(){d(e);let s=c();return u(s.cerrarModal())}),i(),x(3,"img",25),t(4,"h5",26),r(5),i(),t(6,"p",27)(7,"strong"),r(8,"Usuario ID:"),i(),r(9),x(10,"br"),t(11,"strong"),r(12,"Fecha:"),i(),r(13),C(14,"date"),x(15,"br"),t(16,"strong"),r(17,"Categor\xEDa ID:"),i(),r(18),i(),t(19,"div",28)(20,"button",29),p("click",function(){d(e);let s=c();return u(s.eliminarFoto(s.fotoSeleccionada))}),r(21," Eliminar "),i(),t(22,"button",30),p("click",function(){d(e);let s=c();return u(s.cerrarModal())}),r(23," Cancelar "),i()()()()}if(n&2){let e=c();l(3),m("src",e.backendBaseUrl+e.fotoSeleccionada.url,$),l(2),f(e.fotoSeleccionada.titulo),l(4),h(" ",e.fotoSeleccionada.id_usuario,""),l(4),h(" ",S(14,5,e.fotoSeleccionada.fecha,"dd-MM-yyyy"),""),l(5),h(" ",e.fotoSeleccionada.id_categoria," ")}}var P=class n{constructor(o){this.fotoService=o}backendBaseUrl="https://enfoca2-backend.onrender.com";fotos=[];fotoSeleccionada=null;mensaje="";cargando=!1;mostrarModal=!1;ngOnInit(){this.cargarFotos()}cargarFotos(){this.cargando=!0,this.fotoService.obtenerTodas().subscribe({next:o=>{this.fotos=o,this.cargando=!1},error:o=>{console.error(o),this.mensaje="Error al cargar las fotos.",this.cargando=!1}})}seleccionarFoto(o){this.fotoSeleccionada=o,this.mostrarModal=!0}eliminarFoto(o){confirm(`\xBFSeguro que quieres eliminar la foto "${o.titulo}"?`)&&this.fotoService.eliminarFoto(o.id_foto).subscribe({next:()=>{this.mensaje=`\u2705 Foto "${o.titulo}" eliminada correctamente.`,this.fotos=this.fotos.filter(e=>e.id_foto!==o.id_foto),this.fotoSeleccionada=null,this.mostrarModal=!1},error:e=>{console.error(e),this.mensaje="\u274C Error al eliminar la foto."}})}cerrarModal(){this.mostrarModal=!1,this.fotoSeleccionada=null}static \u0275fac=function(e){return new(e||n)(I(ie))};static \u0275cmp=v({type:n,selectors:[["app-delete-photo"]],decls:12,vars:5,consts:[[1,"container","mt-5"],[1,"mb-4","text-center"],["class","alert alert-info text-center rounded-3 shadow-sm",4,"ngIf"],["class","text-center my-4",4,"ngIf"],[1,"row","justify-content-center"],[1,"col-lg-10","col-xl-8","mb-4"],[1,"card","shadow-sm","border-0","rounded-4","mx-auto"],[1,"card-body","p-0"],["class","table table-hover mb-0 rounded-4 overflow-hidden",4,"ngIf"],["class","alert alert-warning m-3 text-center rounded-3 shadow-sm",4,"ngIf"],["class","position-fixed top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center bg-dark bg-opacity-75","style","z-index: 1050",4,"ngIf"],[1,"alert","alert-info","text-center","rounded-3","shadow-sm"],[1,"text-center","my-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"table","table-hover","mb-0","rounded-4","overflow-hidden"],[1,"table-dark"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"bi","bi-trash-fill","me-1"],[1,"alert","alert-warning","m-3","text-center","rounded-3","shadow-sm"],[1,"position-fixed","top-0","start-0","w-100","h-100","d-flex","justify-content-center","align-items-center","bg-dark","bg-opacity-75",2,"z-index","1050"],[1,"bg-white","p-4","rounded","shadow","position-relative",2,"width","90%","max-width","600px","max-height","90vh","overflow-y","auto"],["type","button","aria-label","Cerrar",1,"btn-close","position-absolute","top-0","end-0","m-2",3,"click"],["alt","Vista previa",1,"img-fluid","rounded","mb-3","w-100",2,"max-height","60vh","object-fit","contain",3,"src"],[1,"mb-2","text-center"],[1,"text-center"],[1,"d-flex","gap-2","mt-3"],[1,"btn","btn-danger","w-50",3,"click"],[1,"btn","btn-secondary","w-50",3,"click"]],template:function(e,a){e&1&&(t(0,"div",0)(1,"h4",1),r(2,"Eliminar Fotos"),i(),_(3,fe,2,1,"div",2)(4,xe,4,0,"div",3),t(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7),_(9,_e,13,1,"table",8)(10,he,2,0,"div",9),i()()()(),_(11,ge,24,8,"div",10),i()),e&2&&(l(3),m("ngIf",a.mensaje),l(),m("ngIf",a.cargando),l(5),m("ngIf",a.fotos.length>0),l(),m("ngIf",a.fotos.length===0&&!a.cargando),l(),m("ngIf",a.mostrarModal&&a.fotoSeleccionada))},dependencies:[w,k,M,F,B],encapsulation:2})};var ve=[{path:"",component:V},{path:"ban-user",component:j},{path:"delete-photo",component:P}],T=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=U({type:n});static \u0275inj=E({imports:[q.forChild(ve),q]})};var oe=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=U({type:n});static \u0275inj=E({imports:[w,T]})};export{oe as AdminModule};
